<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word to GIF Translator</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .input-area {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            font-size: 16px;
        }
        
        .buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        button {
            padding: 10px 15px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        
        #speakBtn {
            background-color: #2ecc71;
        }
        
        #speakBtn:hover {
            background-color: #27ae60;
        }
        
        .output-area {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            min-height: 200px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: flex-start;
        }
        
        .gif-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .gif-container {
            width: 200px;
            height: 150px;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .gif-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .word-label {
            margin-top: 5px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .status {
            margin-top: 10px;
            font-style: italic;
            color: #7f8c8d;
        }
        
        .mic-icon {
            display: inline-block;
            width: 12px;
            height: 12px;
            background-color: red;
            border-radius: 50%;
            margin-right: 5px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top-color: #3498db;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <h1>Word to GIF Translator</h1>
    
    <div class="container">
        <div class="input-area">
            <textarea id="textInput" placeholder="Type or speak your text here..."></textarea>
            <div class="buttons">
                <button id="translateBtn">Translate to GIFs</button>
                <button id="speakBtn"><span id="micIndicator" class="mic-icon" style="display: none;"></span>Speak</button>
                <button id="clearBtn">Clear</button>
            </div>
            <div id="status" class="status"></div>
        </div>
        
        <div class="output-area" id="outputArea">
            <p>Your word GIFs will appear here...</p>
        </div>
    </div>
    <div id="sentenceBox" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc; min-height: 50px; font-size: 16px; background: #f9f9f9;">
    <strong>Sentence:</strong> <span id="sentenceText"></span>
</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const textInput = document.getElementById('textInput');
            const translateBtn = document.getElementById('translateBtn');
            const speakBtn = document.getElementById('speakBtn');
            const clearBtn = document.getElementById('clearBtn');
            const outputArea = document.getElementById('outputArea');
            const status = document.getElementById('status');
            const micIndicator = document.getElementById('micIndicator');
            
            // Giphy API configuration
            const GIPHY_API_KEY = 'hpvZycW22qCjn5cRM1xtWB8NKq4dQ2My'; // Public beta key - consider using your own
            const GIPHY_ENDPOINT = 'https://api.giphy.com/v1/gifs/search';
            
            let recognition;
            let isListening = false;
            
            // Check if browser supports speech recognition
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                
                recognition.onstart = function() {
                    isListening = true;
                    micIndicator.style.display = 'inline-block';
                    status.textContent = 'Listening... Speak now.';
                };
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    textInput.value = transcript;
                    processText(transcript);
                };
                
                recognition.onerror = function(event) {
                    isListening = false;
                    micIndicator.style.display = 'none';
                    status.textContent = 'Error occurred in recognition: ' + event.error;
                };
                
                recognition.onend = function() {
                    isListening = false;
                    micIndicator.style.display = 'none';
                    if (status.textContent === 'Listening... Speak now.') {
                        status.textContent = 'Listening ended. Try again if needed.';
                    }
                };
            } else {
                speakBtn.disabled = true;
                speakBtn.title = 'Speech recognition not supported in your browser';
            }
            
            // Button event listeners
            translateBtn.addEventListener('click', function() {
                processText(textInput.value);
            });
            
            speakBtn.addEventListener('click', function() {
                if (!recognition) return;
                
                if (isListening) {
                    recognition.stop();
                } else {
                    try {
                        recognition.start();
                    } catch(ex) {
                        status.textContent = 'Error: ' + ex.message;
                    }
                }
            });
            
            clearBtn.addEventListener('click', function() {
                textInput.value = '';
                outputArea.innerHTML = '<p>Your word GIFs will appear here...</p>';
                status.textContent = '';
            });
            
            // Process text and fetch GIFs
            async function processText(text) {
                if (!text.trim()) {
                    status.textContent = 'Please enter or speak some text first.';
                    return;
                }
                
                outputArea.innerHTML = '<div class="loading"></div> Loading GIFs...';
                status.textContent = 'Fetching GIFs for: "' + text + '"';
                
                // Split into words and process each one
                const words = text.split(/\s+/).filter(word => word.trim() !== '');
                outputArea.innerHTML = '';
                
                for (let i = 0; i < words.length; i++) {
                    const word = words[i];
                    
                    // Create placeholder
                    const placeholder = document.createElement('div');
                    placeholder.className = 'gif-item';
                    placeholder.innerHTML = `
                        <div class="gif-container" style="background-color: #eee; display: flex; justify-content: center; align-items: center;">
                            <div class="loading"></div>
                        </div>
                        <div class="word-label">${word}</div>
                    `;
                    outputArea.appendChild(placeholder);
                    
                    try {
                        // Fetch GIF from Giphy
                        const gifUrl = await fetchGif(word);
                        
                        // Replace placeholder with actual GIF
                        placeholder.innerHTML = `
                            <div class="gif-container">
                                <img src="${gifUrl}" alt="${word} GIF">
                            </div>
                            <div class="word-label">${word}</div>
                        `;
                    } catch (error) {
                        placeholder.innerHTML = `
                            <div class="gif-container" style="background-color: #ffebee; display: flex; justify-content: center; align-items: center;">
                                <span style="color: #c62828;">No GIF found</span>
                            </div>
                            <div class="word-label">${word}</div>
                        `;
                        console.error('Error fetching GIF for word:', word, error);
                    }
                    
                    // Small delay between requests to avoid rate limiting
                    await new Promise(resolve => setTimeout(resolve, 200));
                }
                
                status.textContent = `Displaying ${words.length} word GIFs`;
            }
            
            // Fetch GIF from Giphy API
            async function fetchGif(word) {
                const response = await fetch(`${GIPHY_ENDPOINT}?api_key=${GIPHY_API_KEY}&q=${encodeURIComponent(word)}&limit=1&rating=g`);
                const data = await response.json();
                
                if (data.data.length > 0) {
                    return data.data[0].images.fixed_height.url;
                } else {
                    // Fallback to a random GIF if no exact match
                    const fallbackResponse = await fetch(`${GIPHY_ENDPOINT}?api_key=${GIPHY_API_KEY}&q=funny&limit=50&rating=g`);
                    const fallbackData = await fallbackResponse.json();
                    const randomIndex = Math.floor(Math.random() * Math.min(50, fallbackData.data.length));
                    return fallbackData.data[randomIndex].images.fixed_height.url;
                }
            }
            
            // Allow pressing Enter in the textarea to translate
            textInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    processText(textInput.value);
                }
            });
        });
    </script>
</body>
</html>